using System;
using Telegram.Bot.Types;

namespace Zs.Bot.Telegram
{
    /// <summary>
    /// Обёртка входящего сообщения Telegram.
    /// Сделана по большей части для удобства и на перспективу
    /// </summary>
    internal class TgMessage : Message
    {
        public bool IsEdited { get; set; }
        public int SendingFails { get; set; } // Счётчик неудачных попыток посылки сообщения
        public string FailDescription { get; set; } // Описание проблемы, из-за которой не удалось отправить сообщение
        public int? ReplyToMessageId { get; set; } // Идентификатор сообщения для ответа
        public bool IsSucceed { get; set; }


        public TgMessage(Message msg)
        {
            Parse(msg ?? throw new ArgumentNullException(nameof(msg)));

            Date = Date == default ? DateTime.Now : Date;
        }

        public TgMessage(Chat chat, string msgText)
        {
            Parse(new Message()
            {
                Chat = chat ?? throw new ArgumentNullException(nameof(chat)),
                Text = msgText
            });

            Date = DateTime.Now;
        }


        /// <summary> Наполнение полей класса данными оригинального сообщения </summary>
        internal void Parse(Message msg)
        {
            Animation             = msg.Animation;
            Audio                 = msg.Audio;
            AuthorSignature       = msg.AuthorSignature;
            Caption               = msg.Caption;
            CaptionEntities       = msg.CaptionEntities;
            ChannelChatCreated    = msg.ChannelChatCreated;
            Chat                  = msg.Chat;
            ConnectedWebsite      = msg.ConnectedWebsite;
            Contact               = msg.Contact;
            Date                  = msg.Date;
            DeleteChatPhoto       = msg.DeleteChatPhoto;
            Document              = msg.Document;
            EditDate              = msg.EditDate;
            Entities              = msg.Entities;
            ForwardDate           = msg.ForwardDate;
            ForwardFrom           = msg.ForwardFrom;
            ForwardFromChat       = msg.ForwardFromChat;
            ForwardFromMessageId  = msg.ForwardFromMessageId;
            ForwardSignature      = msg.ForwardSignature;
            From                  = msg.From;
            Game                  = msg.Game;
            GroupChatCreated      = msg.GroupChatCreated;
            Invoice               = msg.Invoice;
            LeftChatMember        = msg.LeftChatMember;
            Location              = msg.Location;
            MediaGroupId          = msg.MediaGroupId;
            MessageId             = msg.MessageId;
            MigrateFromChatId     = msg.MigrateFromChatId;
            MigrateToChatId       = msg.MigrateToChatId;
            NewChatMembers        = msg.NewChatMembers;
            NewChatPhoto          = msg.NewChatPhoto;
            NewChatTitle          = msg.NewChatTitle;
            Photo                 = msg.Photo;
            PinnedMessage         = msg.PinnedMessage;
            ReplyToMessage        = msg.ReplyToMessage;
            Sticker               = msg.Sticker;
            SuccessfulPayment     = msg.SuccessfulPayment;
            SupergroupChatCreated = msg.SupergroupChatCreated;
            Text                  = msg.Text;
            Venue                 = msg.Venue;
            Video                 = msg.Video;
            VideoNote             = msg.VideoNote;
            Voice                 = msg.Voice;
        }
    }
}
