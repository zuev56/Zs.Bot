<#@ template debug="false" hostspecific="true" language="C#" #>
<#@ output extension="generated.cs" #>
<#@ assembly name="System.Core" #>
<#@ assembly name="$(SolutionDir)Zl.Common.T4\bin\Debug\Zs.Common.T4Generator.dll" #>
<#@ import namespace="System.Linq" #>
<#@ import namespace="System.Text" #>
<#@ import namespace="System.Collections.Generic" #>
<#@ import namespace="Zs.Common.T4Generator" #>

<#
    var usings = new[] {
       "using System;",
       "using System.ComponentModel.DataAnnotations;",
       "using System.ComponentModel.DataAnnotations.Schema;"
    };
    
    var filePath = Host.ResolveAssemblyReference("$(ProjectDir)") + @"\DbModel\TableNameToClassNameMap.txt";
    
    var tableToClassNameMap = ModelGenerator.GetTableNameToClassNameMap(filePath);
    
    var databaseInfo = DbReader.GetDbInfo("Host=localhost;Port=5632;Username=postgres;Password=postgres;Database=RobotDb");

    ModelGenerator.GenerateClasses(
        this,
        databaseInfo,
        usings,
        "Zs.Bot.DbModelTEST",
        "internal",
        "Db",
        true,
        tableToClassNameMap
    );


    //ModelGenerator.GenerateEntities(
    //    this,
    //    EntityTypes.DbInterface | EntityTypes.DbClass,
    //    ,
    //    usings,
    //    "Zs.Bot.DbModelTEST",
    //    "internal",
    //    tableToClassNameMap
    //);

#>