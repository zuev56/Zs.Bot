using Microsoft.EntityFrameworkCore;
using Microsoft.VisualStudio.TestTools.UnitTesting;
using Zs.Bot.Model.Db;
using Zs.Service.ChatAdmin;
using Zs.Service.ChatAdmin.DbModel;

namespace Zs.UnitTest.Services.ChatAdmin
{
    [TestClass]
    public class DataBaseUser
    {
        static DataBaseUser() => Init(null);
        
        [ClassInitialize()]
        public static void Init(TestContext testContext)
        {
            var configuration = new Configuration("Zs.Service.ChatAdmin.json",
                                                  dbUser: "app",
                                                  dbPassword: "app");

            var rOptionsBuilder = new DbContextOptionsBuilder<ZsBotDbContext>();
            rOptionsBuilder.UseNpgsql(configuration.ConnectionString);
            ZsBotDbContext.Initialize(rOptionsBuilder.Options);

            var caOptionsBuilder = new DbContextOptionsBuilder<ChatAdminDbContext>();
            caOptionsBuilder.UseNpgsql(configuration.ConnectionString);
            ChatAdminDbContext.Initialize(caOptionsBuilder.Options);
        }
        
        [ClassCleanup]
        public static void TestCleanup()
        {
        }


    }
}
